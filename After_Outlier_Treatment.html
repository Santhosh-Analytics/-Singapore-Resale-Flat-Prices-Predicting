<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Santhoh Kumar">

<title>Model Building - Before Outlier</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
q { quotes: "“" "”" "‘" "’"; }
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="preparing_for_modeling_files/libs/clipboard/clipboard.min.js"></script>
<script src="preparing_for_modeling_files/libs/quarto-html/quarto.js"></script>
<script src="preparing_for_modeling_files/libs/quarto-html/popper.min.js"></script>
<script src="preparing_for_modeling_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="preparing_for_modeling_files/libs/quarto-html/anchor.min.js"></script>
<link href="preparing_for_modeling_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="preparing_for_modeling_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="preparing_for_modeling_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="preparing_for_modeling_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="preparing_for_modeling_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Model Building - Before Outlier</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Santhoh Kumar </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">last-modified</p>
    </div>
  </div>
  
    
  </div>
  


</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#reading-transformed-dataset" id="toc-reading-transformed-dataset"><span class="header-section-number">1</span> <span style="color:Khaki;">Reading Transformed Dataset</span></a></li>
  <li><a href="#encoding-categorical-features" id="toc-encoding-categorical-features"><span class="header-section-number">2</span> <span style="color:Khaki;"> Encoding Categorical Features:</span></a></li>
  <li><a href="#splitting-train-and-test-data" id="toc-splitting-train-and-test-data"><span class="header-section-number">3</span> <span style="color:Khaki;"> Splitting train and test Data:</span></a></li>
  <li><a href="#scaling-data" id="toc-scaling-data"><span class="header-section-number">4</span> <span style="color:Khaki;"> Scaling Data:</span></a></li>
  <li><a href="#training-models" id="toc-training-models"><span class="header-section-number">5</span> <span style="color:Khaki;"> Training Models:</span></a></li>
  <li><a href="#model-selection" id="toc-model-selection"><span class="header-section-number">6</span> <span style="color:Khaki;"> Model Selection:</span></a></li>
  <li><a href="#hyperparameter-tuning-with-grid-search" id="toc-hyperparameter-tuning-with-grid-search"><span class="header-section-number">7</span> <span style="color:Khaki;"> Hyperparameter Tuning with Grid Search:</span></a></li>
  </ul>
</nav>
<h1>
<b>
<div style="padding:25px;background-color:#9B2335;color:white;border-radius:4px;font-size:100%;text-align: center">
Singapore Resale Flat Prices Prediction<br>
</div>
</b></h1><b>
<h2 class="anchored">
<p style="color:Khaki;">
Importing required libraries
</p>
</h2>
<div id="cell-2" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.precision"</span>, <span class="dv">4</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.float_format'</span>, <span class="st">'</span><span class="sc">{:.4f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> pearsonr,kstest, norm, skew,kurtosis, boxcox</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud, STOPWORDS</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>sns.set_theme(context<span class="op">=</span><span class="st">'notebook'</span>, style<span class="op">=</span><span class="st">'white'</span>, palette<span class="op">=</span><span class="st">'dark'</span>, font<span class="op">=</span><span class="st">'sans-serif'</span>, font_scale<span class="op">=</span><span class="dv">1</span>, color_codes<span class="op">=</span><span class="va">True</span>, rc<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>sns.set_style({<span class="st">'axes.facecolor'</span>: <span class="st">'white'</span>,<span class="st">'axes.edgecolor'</span>: <span class="st">'white'</span>})</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>color_good <span class="op">=</span> <span class="st">'</span><span class="ch">\033</span><span class="st">[32m'</span>   <span class="co"># Dark Green for near-zero skew</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>color_okay <span class="op">=</span> <span class="st">'</span><span class="ch">\033</span><span class="st">[92m'</span>   <span class="co"># Light Green for slightly positive or slightly negative skew</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>color_bad <span class="op">=</span> <span class="st">'</span><span class="ch">\033</span><span class="st">[91m'</span>    <span class="co"># Maroon for significant skew</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>color_neutral <span class="op">=</span> <span class="st">'</span><span class="ch">\033</span><span class="st">[0m'</span> <span class="co"># Reset color</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression,Ridge,Lasso,ElasticNet</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor,ExtraTreesRegressor</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split,GridSearchCV,RandomizedSearchCV</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> KFold, cross_val_score</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score, mean_absolute_error, median_absolute_error, explained_variance_score,root_mean_squared_error</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler,LabelEncoder</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> colorama <span class="im">import</span> Fore, Style</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBRegressor</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>color_positive <span class="op">=</span> Fore.GREEN</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>reset_color <span class="op">=</span> Style.RESET_ALL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="reading-transformed-dataset" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="reading-transformed-dataset"><span class="header-section-number">1</span> <span style="color:Khaki;">Reading Transformed Dataset</span></h2>
<div id="cell-5" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df1<span class="op">=</span>pd.read_feather(<span class="st">'data_trans.feather'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-6" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df1.sample(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">town</th>
<th data-quarto-table-cell-role="th">flat_type</th>
<th data-quarto-table-cell-role="th">floor_area_sqm</th>
<th data-quarto-table-cell-role="th">flat_model</th>
<th data-quarto-table-cell-role="th">lease_commence_date</th>
<th data-quarto-table-cell-role="th">resale_price</th>
<th data-quarto-table-cell-role="th">floors</th>
<th data-quarto-table-cell-role="th">floor_no</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">full_address</th>
<th data-quarto-table-cell-role="th">price_per_sqm</th>
<th data-quarto-table-cell-role="th">remaining_lease_year</th>
<th data-quarto-table-cell-role="th">resale_price_boxcox</th>
<th data-quarto-table-cell-role="th">floor_area_boxcox</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">55649</td>
<td>7</td>
<td>Tampines</td>
<td>4 Room</td>
<td>84.0000</td>
<td>Simplified</td>
<td>1985</td>
<td>220000.0000</td>
<td>3</td>
<td>12</td>
<td>2001</td>
<td>833 Tampines St 83 Tampines</td>
<td>2619.0476</td>
<td>83</td>
<td>916.5960</td>
<td>10.9637</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">119614</td>
<td>3</td>
<td>Tampines</td>
<td>4 Room</td>
<td>84.0000</td>
<td>Simplified</td>
<td>1986</td>
<td>228000.0000</td>
<td>3</td>
<td>3</td>
<td>1996</td>
<td>841 Tampines St 83 Tampines</td>
<td>2714.2857</td>
<td>89</td>
<td>933.0806</td>
<td>10.9637</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">277882</td>
<td>10</td>
<td>Bukit Batok</td>
<td>3 Room</td>
<td>64.0000</td>
<td>Simplified</td>
<td>1986</td>
<td>134000.0000</td>
<td>3</td>
<td>6</td>
<td>1999</td>
<td>271 Bt Batok East Ave 4 Bukit Batok</td>
<td>2093.7500</td>
<td>86</td>
<td>715.6356</td>
<td>9.6994</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9678</td>
<td>7</td>
<td>Hougang</td>
<td>4 Room</td>
<td>106.0000</td>
<td>Model A</td>
<td>1992</td>
<td>471000.0000</td>
<td>3</td>
<td>6</td>
<td>2012</td>
<td>462 Hougang Ave 10 Hougang</td>
<td>4443.3962</td>
<td>79</td>
<td>1339.9941</td>
<td>12.1502</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">158520</td>
<td>9</td>
<td>Jurong West</td>
<td>4 Room</td>
<td>91.0000</td>
<td>Model A</td>
<td>2000</td>
<td>240000.0000</td>
<td>3</td>
<td>15</td>
<td>2004</td>
<td>663C Jurong West St 65 Jurong West</td>
<td>2637.3626</td>
<td>95</td>
<td>957.2723</td>
<td>11.3606</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13756</td>
<td>10</td>
<td>Clementi</td>
<td>Executive</td>
<td>161.0000</td>
<td>Maisonette</td>
<td>1984</td>
<td>755500.0000</td>
<td>3</td>
<td>6</td>
<td>2015</td>
<td>116 Clementi St 13 Clementi</td>
<td>5527.9503</td>
<td>68</td>
<td>1696.0073</td>
<td>14.5526</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">124075</td>
<td>5</td>
<td>Hougang</td>
<td>4 Room</td>
<td>106.0000</td>
<td>Model A</td>
<td>1992</td>
<td>320000.0000</td>
<td>3</td>
<td>3</td>
<td>1996</td>
<td>536 Hougang St 52 Hougang</td>
<td>3018.8679</td>
<td>95</td>
<td>1105.0237</td>
<td>12.1502</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30937</td>
<td>8</td>
<td>Tampines</td>
<td>3 Room</td>
<td>74.0000</td>
<td>Model A</td>
<td>1986</td>
<td>377000.0000</td>
<td>3</td>
<td>12</td>
<td>2013</td>
<td>437 Tampines St 43 Tampines</td>
<td>5094.5946</td>
<td>72</td>
<td>1199.1788</td>
<td>10.3586</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">167064</td>
<td>11</td>
<td>Yishun</td>
<td>4 Room</td>
<td>104.0000</td>
<td>Model A</td>
<td>1987</td>
<td>452000.0000</td>
<td>3</td>
<td>3</td>
<td>2023</td>
<td>286 Yishun Ave 6 Yishun</td>
<td>4346.1538</td>
<td>63</td>
<td>1312.7579</td>
<td>12.0492</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">73599</td>
<td>1</td>
<td>Bukit Merah</td>
<td>3 Room</td>
<td>65.0000</td>
<td>Improved</td>
<td>1975</td>
<td>118000.0000</td>
<td>3</td>
<td>12</td>
<td>2002</td>
<td>16 Telok Blangah Cres Bukit Merah</td>
<td>1815.3846</td>
<td>72</td>
<td>671.6045</td>
<td>9.7681</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df1.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 927465 entries, 0 to 181261
Data columns (total 15 columns):
 #   Column                Non-Null Count   Dtype   
---  ------                --------------   -----   
 0   month                 927465 non-null  category
 1   town                  927465 non-null  category
 2   flat_type             927465 non-null  category
 3   floor_area_sqm        927465 non-null  float32 
 4   flat_model            927465 non-null  category
 5   lease_commence_date   927465 non-null  category
 6   resale_price          927465 non-null  float64 
 7   floors                927465 non-null  category
 8   floor_no              927465 non-null  int8    
 9   year                  927465 non-null  category
 10  full_address          927465 non-null  category
 11  price_per_sqm         927465 non-null  float64 
 12  remaining_lease_year  927465 non-null  category
 13  resale_price_boxcox   927465 non-null  float64 
 14  floor_area_boxcox     927465 non-null  float32 
dtypes: category(9), float32(2), float64(3), int8(1)
memory usage: 45.4 MB</code></pre>
</div>
</div>
</section>
<section id="encoding-categorical-features" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="encoding-categorical-features"><span class="header-section-number">2</span> <span style="color:Khaki;"> Encoding Categorical Features:</span></h2>
<div id="cell-9" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>town_en <span class="op">=</span> df1.groupby(<span class="st">'town'</span>,observed<span class="op">=</span><span class="va">False</span>)[<span class="st">'resale_price_boxcox'</span>].median().rank(method<span class="op">=</span><span class="st">'first'</span>).reset_index().sort_values(<span class="st">'resale_price_boxcox'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>town_en_list <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(town_en[<span class="st">'town'</span>], town_en[<span class="st">'resale_price_boxcox'</span>].astype(<span class="bu">int</span>)))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(town_en_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'Lim Chu Kang': 1, 'Queenstown': 2, 'Ang Mo Kio': 3, 'Clementi': 4, 'Geylang': 5, 'Bedok': 6, 'Bukit Batok': 7, 'Yishun': 8, 'Toa Payoh': 9, 'Jurong East': 10, 'Central Area': 11, 'Jurong West': 12, 'Kallang/Whampoa': 13, 'Woodlands': 14, 'Hougang': 15, 'Serangoon': 16, 'Marine Parade': 17, 'Bukit Merah': 18, 'Bukit Panjang': 19, 'Tampines': 20, 'Choa Chu Kang': 21, 'Sembawang': 22, 'Pasir Ris': 23, 'Bishan': 24, 'Bukit Timah': 25, 'Sengkang': 26, 'Punggol': 27}</code></pre>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'town_en'</span>] <span class="op">=</span> df1[<span class="st">'town'</span>].<span class="bu">map</span>(town_en_list)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'town_en'</span>] <span class="op">=</span> df1[<span class="st">'town_en'</span>].astype(<span class="st">'int8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-11" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>year_en <span class="op">=</span> df1.groupby(<span class="st">'year'</span>,observed<span class="op">=</span><span class="va">False</span>)[<span class="st">'resale_price_boxcox'</span>].median().rank(method<span class="op">=</span><span class="st">'first'</span>).reset_index().sort_values(<span class="st">'resale_price_boxcox'</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>year_en_list <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(year_en[<span class="st">'year'</span>], year_en[<span class="st">'resale_price_boxcox'</span>].astype(<span class="bu">int</span>)))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(year_en_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{1990: 1, 1991: 2, 1992: 3, 1993: 4, 1994: 5, 1995: 6, 2002: 7, 2003: 8, 2004: 9, 2001: 10, 2005: 11, 2006: 12, 1999: 13, 2000: 14, 1998: 15, 1996: 16, 2007: 17, 1997: 18, 2008: 19, 2009: 20, 2010: 21, 2019: 22, 2015: 23, 2018: 24, 2011: 25, 2016: 26, 2017: 27, 2014: 28, 2020: 29, 2012: 30, 2013: 31, 2021: 32, 2022: 33, 2023: 34, 2024: 35}</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'year_en'</span>] <span class="op">=</span> df1[<span class="st">'year'</span>].<span class="bu">map</span>(year_en_list)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'year_en'</span>] <span class="op">=</span> df1[<span class="st">'year_en'</span>].astype(<span class="st">'int8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-13" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>flat_type_en <span class="op">=</span> df1.groupby(<span class="st">'flat_type'</span>,observed<span class="op">=</span><span class="va">False</span>)[<span class="st">'resale_price_boxcox'</span>].median().rank(method<span class="op">=</span><span class="st">'first'</span>).reset_index().sort_values(<span class="st">'resale_price_boxcox'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>flat_type_en_list <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(flat_type_en[<span class="st">'flat_type'</span>], flat_type_en[<span class="st">'resale_price_boxcox'</span>].astype(<span class="bu">int</span>)))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(flat_type_en_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'1 Room': 1, '2 Room': 2, '3 Room': 3, '4 Room': 4, '5 Room': 5, 'Executive': 6, 'Multi Generation': 7}</code></pre>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'flat_type_en'</span>] <span class="op">=</span> df1[<span class="st">'flat_type'</span>].<span class="bu">map</span>(flat_type_en_list)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'flat_type_en'</span>] <span class="op">=</span> df1[<span class="st">'flat_type_en'</span>].astype(<span class="st">'int8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-15" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>flat_model_en <span class="op">=</span> df1.groupby(<span class="st">'flat_model'</span>,observed<span class="op">=</span><span class="va">False</span>)[<span class="st">'resale_price_boxcox'</span>].median().rank(method<span class="op">=</span><span class="st">'first'</span>).reset_index().sort_values(<span class="st">'resale_price_boxcox'</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>flat_model_en_list <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(flat_model_en[<span class="st">'flat_model'</span>], flat_model_en[<span class="st">'resale_price_boxcox'</span>].astype(<span class="bu">int</span>)))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(flat_model_en_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'New Generation': 1, 'Standard': 2, 'Simplified': 3, 'Model A2': 4, '2-Room': 5, 'Model A': 6, 'Improved': 7, 'Improved-Maisonette': 8, 'Model A-Maisonette': 9, 'Premium Apartment': 10, 'Adjoined Flat': 11, 'Maisonette': 12, 'Apartment': 13, 'Terrace': 14, 'Multi Generation': 15, 'Premium Maisonette': 16, '3Gen': 17, 'Dbss': 18, 'Premium Apartment Loft': 19, 'Type S1': 20, 'Type S2': 21}</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'flat_model_en'</span>] <span class="op">=</span> df1[<span class="st">'flat_model'</span>].<span class="bu">map</span>(flat_model_en_list)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'flat_model_en'</span>] <span class="op">=</span> df1[<span class="st">'flat_model_en'</span>].astype(<span class="st">'int8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-17" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>lease_commence_en <span class="op">=</span> df1.groupby(<span class="st">'lease_commence_date'</span>,observed<span class="op">=</span><span class="va">False</span>)[<span class="st">'resale_price_boxcox'</span>].median().rank(method<span class="op">=</span><span class="st">'first'</span>).reset_index().sort_values(<span class="st">'resale_price_boxcox'</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>lease_commence_en_list <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(lease_commence_en[<span class="st">'lease_commence_date'</span>], lease_commence_en[<span class="st">'resale_price_boxcox'</span>].astype(<span class="bu">int</span>)))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lease_commence_en_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{1969: 1, 1971: 2, 1967: 3, 1968: 4, 1973: 5, 1970: 6, 1972: 7, 1974: 8, 1977: 9, 1980: 10, 1983: 11, 1975: 12, 1981: 13, 1976: 14, 1978: 15, 1979: 16, 1966: 17, 1982: 18, 1985: 19, 1984: 20, 1986: 21, 1987: 22, 1988: 23, 1990: 24, 1989: 25, 1991: 26, 1997: 27, 1998: 28, 1996: 29, 1999: 30, 1994: 31, 1993: 32, 2000: 33, 1995: 34, 1992: 35, 2001: 36, 2002: 37, 2003: 38, 2004: 39, 2012: 40, 2014: 41, 2015: 42, 2005: 43, 2007: 44, 2010: 45, 2013: 46, 2008: 47, 2016: 48, 2009: 49, 2017: 50, 2018: 51, 2019: 52, 2006: 53, 2020: 54, 2011: 55}</code></pre>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'lease_commence_en'</span>] <span class="op">=</span> df1[<span class="st">'lease_commence_date'</span>].<span class="bu">map</span>(lease_commence_en_list)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'lease_commence_en'</span>] <span class="op">=</span> df1[<span class="st">'lease_commence_en'</span>].astype(<span class="st">'int8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-19" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>floors_en <span class="op">=</span> df1.groupby(<span class="st">'floors'</span>,observed<span class="op">=</span><span class="va">False</span>)[<span class="st">'resale_price_boxcox'</span>].median().rank(method<span class="op">=</span><span class="st">'first'</span>).reset_index().sort_values(<span class="st">'resale_price_boxcox'</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>floors_en_list <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(floors_en[<span class="st">'floors'</span>], floors_en[<span class="st">'resale_price_boxcox'</span>].astype(<span class="bu">int</span>)))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(floors_en_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{3: 1, 5: 2}</code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'floors_en'</span>] <span class="op">=</span> df1[<span class="st">'floors'</span>].<span class="bu">map</span>(floors_en_list)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'floors_en'</span>] <span class="op">=</span> df1[<span class="st">'floors_en'</span>].astype(<span class="st">'int8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-21" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>floor_no_en <span class="op">=</span> df1.groupby(<span class="st">'floor_no'</span>,observed<span class="op">=</span><span class="va">False</span>)[<span class="st">'resale_price_boxcox'</span>].median().rank(method<span class="op">=</span><span class="st">'first'</span>).reset_index().sort_values(<span class="st">'resale_price_boxcox'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>floor_no_en_list <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(floor_no_en[<span class="st">'floor_no'</span>], floor_no_en[<span class="st">'resale_price_boxcox'</span>].astype(<span class="bu">int</span>)))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(floor_no_en_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{3: 1, 6: 2, 9: 3, 12: 4, 15: 5, 5: 6, 18: 7, 10: 8, 21: 9, 24: 10, 20: 11, 27: 12, 25: 13, 35: 14, 40: 15, 30: 16, 33: 17, 36: 18, 39: 19, 42: 20, 45: 21, 48: 22, 51: 23}</code></pre>
</div>
</div>
<div id="cell-22" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'floor_no_en'</span>] <span class="op">=</span> df1[<span class="st">'floor_no'</span>].<span class="bu">map</span>(floor_no_en_list)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'floor_no_en'</span>] <span class="op">=</span> df1[<span class="st">'floor_no_en'</span>].astype(<span class="st">'int8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-23" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>remaining_lease_year_en <span class="op">=</span> df1.groupby(<span class="st">'remaining_lease_year'</span>,observed<span class="op">=</span><span class="va">False</span>)[<span class="st">'resale_price_boxcox'</span>].median().rank(method<span class="op">=</span><span class="st">'first'</span>).reset_index().sort_values(<span class="st">'resale_price_boxcox'</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>remaining_lease_year_en_list <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(remaining_lease_year_en[<span class="st">'remaining_lease_year'</span>], remaining_lease_year_en[<span class="st">'resale_price_boxcox'</span>].astype(<span class="bu">int</span>)))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(remaining_lease_year_en_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{81: 1, 82: 2, 83: 3, 80: 4, 79: 5, 84: 6, 78: 7, 85: 8, 77: 9, 76: 10, 86: 11, 75: 12, 87: 13, 88: 14, 48: 15, 74: 16, 89: 17, 49: 18, 90: 19, 47: 20, 72: 21, 73: 22, 71: 23, 45: 24, 46: 25, 70: 26, 91: 27, 44: 28, 43: 29, 50: 30, 69: 31, 92: 32, 93: 33, 68: 34, 41: 35, 42: 36, 51: 37, 67: 38, 96: 39, 52: 40, 58: 41, 66: 42, 94: 43, 59: 44, 95: 45, 57: 46, 100: 47, 65: 48, 101: 49, 53: 50, 56: 51, 64: 52, 54: 53, 55: 54, 98: 55, 60: 56, 63: 57, 62: 58, 61: 59, 97: 60, 99: 61}</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'remaining_lease_year_en'</span>] <span class="op">=</span> df1[<span class="st">'remaining_lease_year'</span>].<span class="bu">map</span>(remaining_lease_year_en_list)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">'remaining_lease_year_en'</span>] <span class="op">=</span> df1[<span class="st">'remaining_lease_year_en'</span>].astype(<span class="st">'int8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-25" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df1.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>Index(['month', 'town', 'flat_type', 'floor_area_sqm', 'flat_model',
       'lease_commence_date', 'resale_price', 'floors', 'floor_no', 'year',
       'full_address', 'price_per_sqm', 'remaining_lease_year',
       'resale_price_boxcox', 'floor_area_boxcox', 'town_en', 'year_en',
       'flat_type_en', 'flat_model_en', 'lease_commence_en', 'floors_en',
       'floor_no_en', 'remaining_lease_year_en'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df1.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 927465 entries, 0 to 181261
Data columns (total 23 columns):
 #   Column                   Non-Null Count   Dtype   
---  ------                   --------------   -----   
 0   month                    927465 non-null  category
 1   town                     927465 non-null  category
 2   flat_type                927465 non-null  category
 3   floor_area_sqm           927465 non-null  float32 
 4   flat_model               927465 non-null  category
 5   lease_commence_date      927465 non-null  category
 6   resale_price             927465 non-null  float64 
 7   floors                   927465 non-null  category
 8   floor_no                 927465 non-null  int8    
 9   year                     927465 non-null  category
 10  full_address             927465 non-null  category
 11  price_per_sqm            927465 non-null  float64 
 12  remaining_lease_year     927465 non-null  category
 13  resale_price_boxcox      927465 non-null  float64 
 14  floor_area_boxcox        927465 non-null  float32 
 15  town_en                  927465 non-null  int8    
 16  year_en                  927465 non-null  int8    
 17  flat_type_en             927465 non-null  int8    
 18  flat_model_en            927465 non-null  int8    
 19  lease_commence_en        927465 non-null  int8    
 20  floors_en                927465 non-null  int8    
 21  floor_no_en              927465 non-null  int8    
 22  remaining_lease_year_en  927465 non-null  int8    
dtypes: category(9), float32(2), float64(3), int8(9)
memory usage: 52.5 MB</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df1.sample(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">town</th>
<th data-quarto-table-cell-role="th">flat_type</th>
<th data-quarto-table-cell-role="th">floor_area_sqm</th>
<th data-quarto-table-cell-role="th">flat_model</th>
<th data-quarto-table-cell-role="th">lease_commence_date</th>
<th data-quarto-table-cell-role="th">resale_price</th>
<th data-quarto-table-cell-role="th">floors</th>
<th data-quarto-table-cell-role="th">floor_no</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">resale_price_boxcox</th>
<th data-quarto-table-cell-role="th">floor_area_boxcox</th>
<th data-quarto-table-cell-role="th">town_en</th>
<th data-quarto-table-cell-role="th">year_en</th>
<th data-quarto-table-cell-role="th">flat_type_en</th>
<th data-quarto-table-cell-role="th">flat_model_en</th>
<th data-quarto-table-cell-role="th">lease_commence_en</th>
<th data-quarto-table-cell-role="th">floors_en</th>
<th data-quarto-table-cell-role="th">floor_no_en</th>
<th data-quarto-table-cell-role="th">remaining_lease_year_en</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">168019</td>
<td>8</td>
<td>Woodlands</td>
<td>5 Room</td>
<td>118.0000</td>
<td>Improved</td>
<td>1980</td>
<td>325000.0000</td>
<td>3</td>
<td>21</td>
<td>1997</td>
<td>...</td>
<td>1113.6036</td>
<td>12.7321</td>
<td>14</td>
<td>18</td>
<td>5</td>
<td>7</td>
<td>10</td>
<td>1</td>
<td>9</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8133</td>
<td>6</td>
<td>Sengkang</td>
<td>4 Room</td>
<td>90.0000</td>
<td>Model A</td>
<td>2002</td>
<td>365000.0000</td>
<td>3</td>
<td>6</td>
<td>2015</td>
<td>...</td>
<td>1179.9851</td>
<td>11.3051</td>
<td>26</td>
<td>23</td>
<td>4</td>
<td>6</td>
<td>37</td>
<td>1</td>
<td>2</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">155667</td>
<td>8</td>
<td>Central Area</td>
<td>4 Room</td>
<td>87.0000</td>
<td>Improved</td>
<td>1979</td>
<td>240000.0000</td>
<td>3</td>
<td>12</td>
<td>2004</td>
<td>...</td>
<td>957.2723</td>
<td>11.1363</td>
<td>11</td>
<td>9</td>
<td>4</td>
<td>7</td>
<td>16</td>
<td>1</td>
<td>4</td>
<td>16</td>
</tr>
</tbody>
</table>

<p>3 rows × 23 columns</p>
</div>
</div>
</div>
##
<p style="color:Khaki;">
</p><p>Feature Selection:</p>
###
<p style="color:Aqua;">
</p><p>Dropping Categorical Features &amp; Unnecessary:</p>
<div id="cell-30" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df1.drop(columns<span class="op">=</span>[<span class="st">'month'</span>, <span class="st">'town'</span>, <span class="st">'flat_type'</span>, <span class="st">'floor_area_sqm'</span>, <span class="st">'flat_model'</span>,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'lease_commence_date'</span>, <span class="st">'resale_price'</span>, <span class="st">'floors'</span>, <span class="st">'floor_no'</span>, <span class="st">'year'</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'full_address'</span>, <span class="st">'price_per_sqm'</span>, <span class="st">'remaining_lease_year'</span>,],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-31" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df1.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>Index(['resale_price_boxcox', 'floor_area_boxcox', 'town_en', 'year_en',
       'flat_type_en', 'flat_model_en', 'lease_commence_en', 'floors_en',
       'floor_no_en', 'remaining_lease_year_en'],
      dtype='object')</code></pre>
</div>
</div>
###
<p style="color:Aqua;">
</p><p>Correlation:</p>
<div id="cell-33" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cor_col <span class="op">=</span> df1.select_dtypes(include<span class="op">=</span><span class="st">'number'</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix_pear <span class="op">=</span> cor_col.corr()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">8</span>))</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix_pear,annot<span class="op">=</span><span class="va">True</span>,fmt<span class="op">=</span><span class="st">'.2f'</span>,cmap<span class="op">=</span><span class="st">'coolwarm'</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Pearson Correlation Matrix'</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>cor_col <span class="op">=</span> df1.select_dtypes(include<span class="op">=</span><span class="st">'number'</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> cor_col.corr(method<span class="op">=</span><span class="st">'spearman'</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix,annot<span class="op">=</span><span class="va">True</span>,fmt<span class="op">=</span><span class="st">'.2f'</span>,cmap<span class="op">=</span><span class="st">'coolwarm'</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Spearman Correlation Matrix'</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preparing_for_modeling_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-34" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>target_corr <span class="op">=</span> df1.select_dtypes(include<span class="op">=</span><span class="st">'number'</span>).corr(method<span class="op">=</span><span class="st">'spearman'</span>)[<span class="st">'resale_price_boxcox'</span>].<span class="bu">abs</span>().sort_values(ascending<span class="op">=</span><span class="va">False</span>)[<span class="dv">1</span>:]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>target_corr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>year_en                   0.7226
flat_type_en              0.6297
floor_area_boxcox         0.6048
lease_commence_en         0.5447
flat_model_en             0.4460
town_en                   0.3115
remaining_lease_year_en   0.2378
floor_no_en               0.1616
floors_en                 0.0792
Name: resale_price_boxcox, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="splitting-train-and-test-data" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="splitting-train-and-test-data"><span class="header-section-number">3</span> <span style="color:Khaki;"> Splitting train and test Data:</span></h2>
<div id="cell-36" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df1.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>Index(['resale_price_boxcox', 'floor_area_boxcox', 'town_en', 'year_en',
       'flat_type_en', 'flat_model_en', 'lease_commence_en', 'floors_en',
       'floor_no_en', 'remaining_lease_year_en'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-37" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(df1.drop([<span class="st">'resale_price_boxcox'</span>], axis<span class="op">=</span><span class="dv">1</span>), df1[[<span class="st">'resale_price_boxcox'</span>]].values.ravel(), test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="scaling-data" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="scaling-data"><span class="header-section-number">4</span> <span style="color:Khaki;"> Scaling Data:</span></h2>
<div id="cell-39" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>scale_reg <span class="op">=</span> StandardScaler().fit(x_train)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>x_train<span class="op">=</span>scale_reg.transform(x_train)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>x_test<span class="op">=</span>scale_reg.transform(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-40" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>x_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>array([[ 0.5437164 ,  1.1021194 , -0.8121976 , ..., -0.08619591,
        -0.5104581 ,  1.37244   ],
       [ 1.1561977 ,  0.24968383,  0.72176117, ..., -0.08619591,
         0.4832754 ,  1.5554725 ],
       [-0.09750392, -1.4551873 ,  0.72176117, ..., -0.08619591,
        -1.0073249 ,  1.311429  ],
       ...,
       [-0.4257452 , -1.0289696 , -0.15478669, ..., -0.08619591,
        -0.5104581 , -1.1900164 ],
       [-0.1375082 ,  1.8124825 ,  1.3791722 , ..., -0.08619591,
        -1.0073249 ,  1.0063747 ],
       [-1.147978  ,  0.39175642, -0.15478669, ..., -0.08619591,
        -0.5104581 , -0.5799077 ]], dtype=float32)</code></pre>
</div>
</div>
###
<p style="color:Aqua;">
</p><p>Pickle Scaling:</p>
<div id="cell-42" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="vs">r'pkls/scale_reg.pkl'</span>, <span class="st">'wb'</span>) <span class="im">as</span> f:</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    pickle.dump(scale_reg,f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-43" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_train.shape, <span class="st">'</span><span class="ch">\n\n</span><span class="st">'</span>,y_train.shape)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_test.shape, <span class="st">'</span><span class="ch">\n\n</span><span class="st">'</span>,y_test.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(741972, 9) 

 (741972,)
(185493, 9) 

 (185493,)</code></pre>
</div>
</div>
</section>
<section id="training-models" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="training-models"><span class="header-section-number">5</span> <span style="color:Khaki;"> Training Models:</span></h2>
###
<p style="color:Aqua;">
</p><p>Linear Regression:</p>
<div id="cell-46" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>LR_model <span class="op">=</span> LinearRegression()</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>LR_model.fit(x_train,y_train)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>y_preds<span class="op">=</span>LR_model.predict(x_test)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>y_preds_train <span class="op">=</span> LR_model.predict(x_train)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>training_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Training Time: </span><span class="sc">{</span>training_time<span class="sc">:.2f}</span><span class="ss"> seconds</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Coefficients - </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>LR_model<span class="sc">.</span>coef_<span class="sc">}</span><span class="ss"> "</span>)</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training Time: 0.13 seconds

Coefficients -  [101.60953    -6.7012787 184.82661    47.809685    8.961584   20.656532
  -7.6220946  32.06047    18.875324 ] 
Test Mean Squared Error  -- 10875.21
Train Mean Squared Error  -- 10848.44

Test Root Mean Squared Error  -- 104.28
Train Root Mean Squared Error  -- 104.16

Test R2 Score  -- 0.87
Train R2 Score  -- 0.87

Test Mean Absolute Error  -- 80.75
Train Mean Absolute Error  -- 80.71

Test Median Absolute Error  -- 65.10
Train Median Absolute Error  -- 65.08

Test Explained Var  -- 0.87
Train Explained Var  -- 0.87

--------------------------------------------------</code></pre>
</div>
</div>
###
<p style="color:Aqua;">
</p><p>Lasso:</p>
<div id="cell-48" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>Lasso_model <span class="op">=</span> Lasso(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>Lasso_model.fit(x_train,y_train)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>y_preds<span class="op">=</span>Lasso_model.predict(x_test)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>y_preds_train <span class="op">=</span> Lasso_model.predict(x_train)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>training_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Training Time: </span><span class="sc">{</span>training_time<span class="sc">:.2f}</span><span class="ss"> seconds</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training Time: 0.55 seconds

Test Mean Squared Error  -- 10886.49
Train Mean Squared Error  -- 10856.54

Test Root Mean Squared Error  -- 104.34
Train Root Mean Squared Error  -- 104.19

Test R2 Score  -- 0.87
Train R2 Score  -- 0.87

Test Mean Absolute Error  -- 80.70
Train Mean Absolute Error  -- 80.63

Test Median Absolute Error  -- 64.95
Train Median Absolute Error  -- 64.91

Test Explained Var  -- 0.87
Train Explained Var  -- 0.87

--------------------------------------------------</code></pre>
</div>
</div>
###
<p style="color:Aqua;">
</p><p>ElasticNet:</p>
<div id="cell-50" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>EN_model <span class="op">=</span> ElasticNet(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>EN_model.fit(x_train,y_train)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>y_preds<span class="op">=</span>EN_model.predict(x_test)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>y_preds_train <span class="op">=</span> EN_model.predict(x_train)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>training_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Training Time: </span><span class="sc">{</span>training_time<span class="sc">:.2f}</span><span class="ss"> seconds</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training Time: 0.18 seconds

Test Mean Squared Error  -- 15681.17
Train Mean Squared Error  -- 15606.67

Test Root Mean Squared Error  -- 125.22
Train Root Mean Squared Error  -- 124.93

Test R2 Score  -- 0.81
Train R2 Score  -- 0.81

Test Mean Absolute Error  -- 94.66
Train Mean Absolute Error  -- 94.47

Test Median Absolute Error  -- 73.06
Train Median Absolute Error  -- 72.99

Test Explained Var  -- 0.81
Train Explained Var  -- 0.81

--------------------------------------------------</code></pre>
</div>
</div>
###
<p style="color:Aqua;">
</p><p>Decision Tree Regressor:</p>
<div id="cell-52" class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>DT_model <span class="op">=</span> DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">42</span>,max_depth<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>DT_model.fit(x_train,y_train)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>y_preds<span class="op">=</span>DT_model.predict(x_test)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>y_preds_train <span class="op">=</span> DT_model.predict(x_train)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>training_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Training Time: </span><span class="sc">{</span>training_time<span class="sc">:.2f}</span><span class="ss"> seconds</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training Time: 2.04 seconds

Test Mean Squared Error  -- 8190.89
Train Mean Squared Error  -- 8152.49

Test Root Mean Squared Error  -- 90.50
Train Root Mean Squared Error  -- 90.29

Test R2 Score  -- 0.90
Train R2 Score  -- 0.90

Test Mean Absolute Error  -- 67.96
Train Mean Absolute Error  -- 67.82

Test Median Absolute Error  -- 52.90
Train Median Absolute Error  -- 52.73

Test Explained Var  -- 0.90
Train Explained Var  -- 0.90

--------------------------------------------------</code></pre>
</div>
</div>
###
<p style="color:Aqua;">
</p><p>KNN Regressor:</p>
<div id="cell-54" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'n_neighbors'</span> : [<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>]}</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>KNN_grid_model <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>KNeighborsRegressor(), param_grid<span class="op">=</span>params, cv<span class="op">=</span><span class="dv">5</span>, scoring<span class="op">=</span><span class="st">'r2'</span>,verbose<span class="op">=</span><span class="dv">3</span>, n_jobs<span class="op">=</span><span class="dv">1</span>,error_score<span class="op">=</span><span class="st">'raise'</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>KNN_grid_model.fit(x_train,y_train)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>y_preds<span class="op">=</span>KNN_grid_model.predict(x_test)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>y_preds_train <span class="op">=</span> KNN_grid_model.predict(x_train)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>training_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Training Time: </span><span class="sc">{</span>training_time<span class="sc">:.2f}</span><span class="ss"> seconds</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 5 folds for each of 4 candidates, totalling 20 fits
[CV 1/5] END .....................n_neighbors=2;, score=0.957 total time=  28.7s
[CV 2/5] END .....................n_neighbors=2;, score=0.958 total time=  27.4s
[CV 3/5] END .....................n_neighbors=2;, score=0.957 total time=  27.8s
[CV 4/5] END .....................n_neighbors=2;, score=0.957 total time=  27.4s
[CV 5/5] END .....................n_neighbors=2;, score=0.958 total time=  34.6s
[CV 1/5] END .....................n_neighbors=3;, score=0.959 total time=  33.9s
[CV 2/5] END .....................n_neighbors=3;, score=0.959 total time=  25.7s
[CV 3/5] END .....................n_neighbors=3;, score=0.959 total time=  25.6s
[CV 4/5] END .....................n_neighbors=3;, score=0.959 total time=  25.7s
[CV 5/5] END .....................n_neighbors=3;, score=0.960 total time=  26.2s
[CV 1/5] END .....................n_neighbors=4;, score=0.959 total time=  28.3s
[CV 2/5] END .....................n_neighbors=4;, score=0.959 total time=  28.3s
[CV 3/5] END .....................n_neighbors=4;, score=0.959 total time=  28.1s
[CV 4/5] END .....................n_neighbors=4;, score=0.959 total time=  28.6s
[CV 5/5] END .....................n_neighbors=4;, score=0.960 total time=  29.3s
[CV 1/5] END .....................n_neighbors=5;, score=0.959 total time=  31.3s
[CV 2/5] END .....................n_neighbors=5;, score=0.959 total time=  31.9s
[CV 3/5] END .....................n_neighbors=5;, score=0.958 total time=  31.8s
[CV 4/5] END .....................n_neighbors=5;, score=0.959 total time=  32.0s
[CV 5/5] END .....................n_neighbors=5;, score=0.959 total time=  31.7s
Training Time: 770.57 seconds

Test Mean Squared Error  -- 751.02
Train Mean Squared Error  -- 459.61

Test Root Mean Squared Error  -- 27.40
Train Root Mean Squared Error  -- 21.44

Test R2 Score  -- 0.96
Train R2 Score  -- 0.98

Test Mean Absolute Error  -- 19.23
Train Mean Absolute Error  -- 15.17

Test Median Absolute Error  -- 13.63
Train Median Absolute Error  -- 10.82

Test Explained Var  -- 0.96
Train Explained Var  -- 0.98

--------------------------------------------------</code></pre>
</div>
</div>
<div id="cell-55" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>KNN_model <span class="op">=</span> KNeighborsRegressor(n_neighbors<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>KNN_model.fit(x_train,y_train)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>y_preds<span class="op">=</span>KNN_model.predict(x_test)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>y_preds_train <span class="op">=</span> KNN_model.predict(x_train)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>training_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Training Time: </span><span class="sc">{</span>training_time<span class="sc">:.2f}</span><span class="ss"> seconds</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training Time: 262.11 seconds

Test Mean Squared Error  -- 3144.13
Train Mean Squared Error  -- 1936.66

Test Root Mean Squared Error  -- 56.07
Train Root Mean Squared Error  -- 44.01

Test R2 Score  -- 0.96
Train R2 Score  -- 0.98

Test Mean Absolute Error  -- 39.40
Train Mean Absolute Error  -- 31.11

Test Median Absolute Error  -- 27.93
Train Median Absolute Error  -- 22.22

Test Explained Var  -- 0.96
Train Explained Var  -- 0.98

--------------------------------------------------</code></pre>
</div>
</div>
###
<p style="color:Aqua;">
</p><p>Extra Tree Regressor:</p>
<div id="cell-57" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>ET_model <span class="op">=</span> ExtraTreesRegressor(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>ET_model.fit(x_train,y_train)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>y_preds<span class="op">=</span>ET_model.predict(x_test)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>y_preds_train <span class="op">=</span> ET_model.predict(x_train)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>training_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Training Time: </span><span class="sc">{</span>training_time<span class="sc">:.2f}</span><span class="ss"> seconds</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training Time: 275.73 seconds

Test Mean Squared Error  -- 2118.34
Train Mean Squared Error  -- 824.59

Test Root Mean Squared Error  -- 46.03
Train Root Mean Squared Error  -- 28.72

Test R2 Score  -- 0.97
Train R2 Score  -- 0.99

Test Mean Absolute Error  -- 33.22
Train Mean Absolute Error  -- 18.32

Test Median Absolute Error  -- 24.40
Train Median Absolute Error  -- 11.36

Test Explained Var  -- 0.97
Train Explained Var  -- 0.99

--------------------------------------------------</code></pre>
</div>
</div>
###
<p style="color:Aqua;">
</p><p>Random Forest Regressor:</p>
<div id="cell-59" class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>RF_model <span class="op">=</span> RandomForestRegressor(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>RF_model.fit(x_train,y_train)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>y_preds<span class="op">=</span>RF_model.predict(x_test)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>y_preds_train <span class="op">=</span> RF_model.predict(x_train)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>training_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Training Time: </span><span class="sc">{</span>training_time<span class="sc">:.2f}</span><span class="ss"> seconds</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
###
<p style="color:Aqua;">
</p><p>XG Boost Regressor:</p>
<div id="cell-61" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>XGB_model <span class="op">=</span> XGBRegressor(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>XGB_model.fit(x_train,y_train)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>y_preds<span class="op">=</span>XGB_model.predict(x_test)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>y_preds_train <span class="op">=</span> XGB_model.predict(x_train)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>training_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Training Time: </span><span class="sc">{</span>training_time<span class="sc">:.2f}</span><span class="ss"> seconds</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training Time: 5.76 seconds

Test Mean Squared Error  -- 2188.08
Train Mean Squared Error  -- 2157.83

Test Root Mean Squared Error  -- 46.78
Train Root Mean Squared Error  -- 46.45

Test R2 Score  -- 0.97
Train R2 Score  -- 0.97

Test Mean Absolute Error  -- 35.32
Train Mean Absolute Error  -- 35.08

Test Median Absolute Error  -- 27.49
Train Median Absolute Error  -- 27.38

Test Explained Var  -- 0.97
Train Explained Var  -- 0.97

--------------------------------------------------</code></pre>
</div>
</div>
<div id="cell-62" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">"max_depth"</span>:    [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"n_estimators"</span>: [<span class="dv">500</span>, <span class="dv">600</span>, <span class="dv">700</span>],</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"learning_rate"</span>: [<span class="fl">0.01</span>, <span class="fl">0.015</span>]}</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> plot_importance</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'fivethirtyeight'</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'font.size'</span>: <span class="dv">16</span>})</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>plot_importance(XGB_model, max_num_features<span class="op">=</span><span class="dv">8</span>, ax<span class="op">=</span>ax)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="preparing_for_modeling_files/figure-html/cell-44-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-selection" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="model-selection"><span class="header-section-number">6</span> <span style="color:Khaki;"> Model Selection:</span></h2>
###
<p style="color:Aqua">
Evaluation:
</p>
<ul>
<li><p><span style="color:Aqua"> <b>Linear Regression and Lasso - </b></span> Both have the same R2 score and similar MSEs. They show a good fit but are slightly worse compared to other models like XGBoost and Extra Trees.</p></li>
<li><p><span style="color:Aqua"> <b> ElasticNet - </b></span> Shows lower performance with an R2 score of 0.81, indicating underfitting.</p></li>
<li><p><span style="color:Aqua"> <b> Decision Tree Regressor - </b></span> Shows good performance with an R2 score of 0.90 but is outperformed by ensemble methods.</p></li>
<li><p><span style="color:Aqua"> <b> KNeighbors Regressor - </b></span> Shows very high R2 scores (0.96 for test, 0.98 for train) but has a significant difference between training and testing MSEs, indicating potential overfitting.</p></li>
<li><p><span style="color:Aqua"> <b> Extra Trees Regressor - </b></span> Shows excellent performance with very high R2 scores but has a significant difference between training and testing MSEs, indicating potential overfitting.</p></li>
<li><p><span style="color:Aqua"> <b> XGBoost Regressor - </b></span> Shows excellent performance with very high R2 scores for both test and train. It has a smaller gap between training and testing errors compared to Extra Trees, indicating less overfitting.</p></li>
</ul>
###
<p style="color:Aqua">
XGBoost Regressor is the best model in this case, with balanced performance and minimal overfitting.
</p>
<p>&lt;p Style=<q>color:Aqua</q></p>
</section>
<section id="hyperparameter-tuning-with-grid-search" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="hyperparameter-tuning-with-grid-search"><span class="header-section-number">7</span> <span style="color:Khaki;"> Hyperparameter Tuning with Grid Search:</span></h2>
<div id="cell-68" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>],</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: [<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>],</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'subsample'</span>: [<span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1.0</span>]</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-69" class="cell" data-execution_count="45">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>xgb_grid <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>XGBRegressor(random_state<span class="op">=</span><span class="dv">42</span>), param_grid<span class="op">=</span>param_grid, scoring<span class="op">=</span><span class="st">'r2'</span>, cv<span class="op">=</span><span class="dv">3</span>, verbose<span class="op">=</span><span class="dv">3</span>, n_jobs<span class="op">=</span><span class="dv">1</span>,error_score<span class="op">=</span><span class="st">'raise'</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>xgb_grid.fit(x_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 3 folds for each of 81 candidates, totalling 243 fits
[CV 1/3] END learning_rate=0.01, max_depth=3, n_estimators=100, subsample=0.6;, score=0.708 total time=   2.0s
[CV 2/3] END learning_rate=0.01, max_depth=3, n_estimators=100, subsample=0.6;, score=0.709 total time=   1.6s
[CV 3/3] END learning_rate=0.01, max_depth=3, n_estimators=100, subsample=0.6;, score=0.709 total time=   1.6s
[CV 1/3] END learning_rate=0.01, max_depth=3, n_estimators=100, subsample=0.8;, score=0.708 total time=   1.6s
[CV 2/3] END learning_rate=0.01, max_depth=3, n_estimators=100, subsample=0.8;, score=0.709 total time=   1.7s
[CV 3/3] END learning_rate=0.01, max_depth=3, n_estimators=100, subsample=0.8;, score=0.709 total time=   1.8s
[CV 1/3] END learning_rate=0.01, max_depth=3, n_estimators=100, subsample=1.0;, score=0.708 total time=   1.4s
[CV 2/3] END learning_rate=0.01, max_depth=3, n_estimators=100, subsample=1.0;, score=0.709 total time=   1.7s
[CV 3/3] END learning_rate=0.01, max_depth=3, n_estimators=100, subsample=1.0;, score=0.709 total time=   2.0s
[CV 1/3] END learning_rate=0.01, max_depth=3, n_estimators=200, subsample=0.6;, score=0.851 total time=   2.9s
[CV 2/3] END learning_rate=0.01, max_depth=3, n_estimators=200, subsample=0.6;, score=0.851 total time=   3.1s
[CV 3/3] END learning_rate=0.01, max_depth=3, n_estimators=200, subsample=0.6;, score=0.852 total time=   3.3s
[CV 1/3] END learning_rate=0.01, max_depth=3, n_estimators=200, subsample=0.8;, score=0.851 total time=   2.9s
[CV 2/3] END learning_rate=0.01, max_depth=3, n_estimators=200, subsample=0.8;, score=0.851 total time=   3.3s
[CV 3/3] END learning_rate=0.01, max_depth=3, n_estimators=200, subsample=0.8;, score=0.852 total time=   3.2s
[CV 1/3] END learning_rate=0.01, max_depth=3, n_estimators=200, subsample=1.0;, score=0.851 total time=   4.6s
[CV 2/3] END learning_rate=0.01, max_depth=3, n_estimators=200, subsample=1.0;, score=0.851 total time=   3.1s
[CV 3/3] END learning_rate=0.01, max_depth=3, n_estimators=200, subsample=1.0;, score=0.852 total time=   2.5s
[CV 1/3] END learning_rate=0.01, max_depth=3, n_estimators=300, subsample=0.6;, score=0.890 total time=   3.5s
[CV 2/3] END learning_rate=0.01, max_depth=3, n_estimators=300, subsample=0.6;, score=0.891 total time=   4.4s
[CV 3/3] END learning_rate=0.01, max_depth=3, n_estimators=300, subsample=0.6;, score=0.891 total time=   4.6s
[CV 1/3] END learning_rate=0.01, max_depth=3, n_estimators=300, subsample=0.8;, score=0.891 total time=   5.8s
[CV 2/3] END learning_rate=0.01, max_depth=3, n_estimators=300, subsample=0.8;, score=0.891 total time=   4.8s
[CV 3/3] END learning_rate=0.01, max_depth=3, n_estimators=300, subsample=0.8;, score=0.891 total time=   4.0s
[CV 1/3] END learning_rate=0.01, max_depth=3, n_estimators=300, subsample=1.0;, score=0.891 total time=   4.3s
[CV 2/3] END learning_rate=0.01, max_depth=3, n_estimators=300, subsample=1.0;, score=0.891 total time=   3.8s
[CV 3/3] END learning_rate=0.01, max_depth=3, n_estimators=300, subsample=1.0;, score=0.891 total time=   3.8s
[CV 1/3] END learning_rate=0.01, max_depth=5, n_estimators=100, subsample=0.6;, score=0.767 total time=   2.2s
[CV 2/3] END learning_rate=0.01, max_depth=5, n_estimators=100, subsample=0.6;, score=0.768 total time=   2.2s
[CV 3/3] END learning_rate=0.01, max_depth=5, n_estimators=100, subsample=0.6;, score=0.767 total time=   2.4s
[CV 1/3] END learning_rate=0.01, max_depth=5, n_estimators=100, subsample=0.8;, score=0.767 total time=   2.3s
[CV 2/3] END learning_rate=0.01, max_depth=5, n_estimators=100, subsample=0.8;, score=0.768 total time=   2.2s
[CV 3/3] END learning_rate=0.01, max_depth=5, n_estimators=100, subsample=0.8;, score=0.767 total time=   2.1s
[CV 1/3] END learning_rate=0.01, max_depth=5, n_estimators=100, subsample=1.0;, score=0.767 total time=   2.3s
[CV 2/3] END learning_rate=0.01, max_depth=5, n_estimators=100, subsample=1.0;, score=0.768 total time=   2.3s
[CV 3/3] END learning_rate=0.01, max_depth=5, n_estimators=100, subsample=1.0;, score=0.768 total time=   2.2s
[CV 1/3] END learning_rate=0.01, max_depth=5, n_estimators=200, subsample=0.6;, score=0.892 total time=   4.2s
[CV 2/3] END learning_rate=0.01, max_depth=5, n_estimators=200, subsample=0.6;, score=0.893 total time=   4.2s
[CV 3/3] END learning_rate=0.01, max_depth=5, n_estimators=200, subsample=0.6;, score=0.893 total time=   4.3s
[CV 1/3] END learning_rate=0.01, max_depth=5, n_estimators=200, subsample=0.8;, score=0.893 total time=   4.1s
[CV 2/3] END learning_rate=0.01, max_depth=5, n_estimators=200, subsample=0.8;, score=0.893 total time=   4.1s
[CV 3/3] END learning_rate=0.01, max_depth=5, n_estimators=200, subsample=0.8;, score=0.893 total time=   4.4s
[CV 1/3] END learning_rate=0.01, max_depth=5, n_estimators=200, subsample=1.0;, score=0.892 total time=   4.0s
[CV 2/3] END learning_rate=0.01, max_depth=5, n_estimators=200, subsample=1.0;, score=0.893 total time=   4.0s
[CV 3/3] END learning_rate=0.01, max_depth=5, n_estimators=200, subsample=1.0;, score=0.893 total time=   4.1s
[CV 1/3] END learning_rate=0.01, max_depth=5, n_estimators=300, subsample=0.6;, score=0.922 total time=   6.0s
[CV 2/3] END learning_rate=0.01, max_depth=5, n_estimators=300, subsample=0.6;, score=0.922 total time=   7.2s
[CV 3/3] END learning_rate=0.01, max_depth=5, n_estimators=300, subsample=0.6;, score=0.923 total time=   6.0s
[CV 1/3] END learning_rate=0.01, max_depth=5, n_estimators=300, subsample=0.8;, score=0.922 total time=   5.9s
[CV 2/3] END learning_rate=0.01, max_depth=5, n_estimators=300, subsample=0.8;, score=0.922 total time=   6.0s
[CV 3/3] END learning_rate=0.01, max_depth=5, n_estimators=300, subsample=0.8;, score=0.923 total time=   6.1s
[CV 1/3] END learning_rate=0.01, max_depth=5, n_estimators=300, subsample=1.0;, score=0.922 total time=   5.8s
[CV 2/3] END learning_rate=0.01, max_depth=5, n_estimators=300, subsample=1.0;, score=0.922 total time=   5.6s
[CV 3/3] END learning_rate=0.01, max_depth=5, n_estimators=300, subsample=1.0;, score=0.922 total time=   5.7s
[CV 1/3] END learning_rate=0.01, max_depth=7, n_estimators=100, subsample=0.6;, score=0.790 total time=   3.1s
[CV 2/3] END learning_rate=0.01, max_depth=7, n_estimators=100, subsample=0.6;, score=0.790 total time=   3.0s
[CV 3/3] END learning_rate=0.01, max_depth=7, n_estimators=100, subsample=0.6;, score=0.790 total time=   3.1s
[CV 1/3] END learning_rate=0.01, max_depth=7, n_estimators=100, subsample=0.8;, score=0.790 total time=   3.0s
[CV 2/3] END learning_rate=0.01, max_depth=7, n_estimators=100, subsample=0.8;, score=0.790 total time=   3.1s
[CV 3/3] END learning_rate=0.01, max_depth=7, n_estimators=100, subsample=0.8;, score=0.790 total time=   3.0s
[CV 1/3] END learning_rate=0.01, max_depth=7, n_estimators=100, subsample=1.0;, score=0.790 total time=   3.0s
[CV 2/3] END learning_rate=0.01, max_depth=7, n_estimators=100, subsample=1.0;, score=0.790 total time=   3.0s
[CV 3/3] END learning_rate=0.01, max_depth=7, n_estimators=100, subsample=1.0;, score=0.790 total time=   3.0s
[CV 1/3] END learning_rate=0.01, max_depth=7, n_estimators=200, subsample=0.6;, score=0.913 total time=   5.6s
[CV 2/3] END learning_rate=0.01, max_depth=7, n_estimators=200, subsample=0.6;, score=0.913 total time=   5.7s
[CV 3/3] END learning_rate=0.01, max_depth=7, n_estimators=200, subsample=0.6;, score=0.913 total time=   5.8s
[CV 1/3] END learning_rate=0.01, max_depth=7, n_estimators=200, subsample=0.8;, score=0.912 total time=   5.5s
[CV 2/3] END learning_rate=0.01, max_depth=7, n_estimators=200, subsample=0.8;, score=0.913 total time=   5.6s
[CV 3/3] END learning_rate=0.01, max_depth=7, n_estimators=200, subsample=0.8;, score=0.913 total time=   5.6s
[CV 1/3] END learning_rate=0.01, max_depth=7, n_estimators=200, subsample=1.0;, score=0.913 total time=   5.5s
[CV 2/3] END learning_rate=0.01, max_depth=7, n_estimators=200, subsample=1.0;, score=0.913 total time=   6.0s
[CV 3/3] END learning_rate=0.01, max_depth=7, n_estimators=200, subsample=1.0;, score=0.913 total time=   5.5s
[CV 1/3] END learning_rate=0.01, max_depth=7, n_estimators=300, subsample=0.6;, score=0.941 total time=   8.1s
[CV 2/3] END learning_rate=0.01, max_depth=7, n_estimators=300, subsample=0.6;, score=0.941 total time=   8.1s
[CV 3/3] END learning_rate=0.01, max_depth=7, n_estimators=300, subsample=0.6;, score=0.942 total time=   8.4s
[CV 1/3] END learning_rate=0.01, max_depth=7, n_estimators=300, subsample=0.8;, score=0.941 total time=   8.1s
[CV 2/3] END learning_rate=0.01, max_depth=7, n_estimators=300, subsample=0.8;, score=0.941 total time=   8.0s
[CV 3/3] END learning_rate=0.01, max_depth=7, n_estimators=300, subsample=0.8;, score=0.942 total time=   8.0s
[CV 1/3] END learning_rate=0.01, max_depth=7, n_estimators=300, subsample=1.0;, score=0.941 total time=   7.9s
[CV 2/3] END learning_rate=0.01, max_depth=7, n_estimators=300, subsample=1.0;, score=0.941 total time=   8.0s
[CV 3/3] END learning_rate=0.01, max_depth=7, n_estimators=300, subsample=1.0;, score=0.942 total time=   7.8s
[CV 1/3] END learning_rate=0.1, max_depth=3, n_estimators=100, subsample=0.6;, score=0.939 total time=   1.6s
[CV 2/3] END learning_rate=0.1, max_depth=3, n_estimators=100, subsample=0.6;, score=0.941 total time=   1.6s
[CV 3/3] END learning_rate=0.1, max_depth=3, n_estimators=100, subsample=0.6;, score=0.941 total time=   1.7s
[CV 1/3] END learning_rate=0.1, max_depth=3, n_estimators=100, subsample=0.8;, score=0.940 total time=   1.5s
[CV 2/3] END learning_rate=0.1, max_depth=3, n_estimators=100, subsample=0.8;, score=0.941 total time=   1.6s
[CV 3/3] END learning_rate=0.1, max_depth=3, n_estimators=100, subsample=0.8;, score=0.940 total time=   1.8s
[CV 1/3] END learning_rate=0.1, max_depth=3, n_estimators=100, subsample=1.0;, score=0.941 total time=   1.5s
[CV 2/3] END learning_rate=0.1, max_depth=3, n_estimators=100, subsample=1.0;, score=0.941 total time=   1.5s
[CV 3/3] END learning_rate=0.1, max_depth=3, n_estimators=100, subsample=1.0;, score=0.941 total time=   1.5s
[CV 1/3] END learning_rate=0.1, max_depth=3, n_estimators=200, subsample=0.6;, score=0.955 total time=   2.8s
[CV 2/3] END learning_rate=0.1, max_depth=3, n_estimators=200, subsample=0.6;, score=0.954 total time=   2.7s
[CV 3/3] END learning_rate=0.1, max_depth=3, n_estimators=200, subsample=0.6;, score=0.956 total time=   2.8s
[CV 1/3] END learning_rate=0.1, max_depth=3, n_estimators=200, subsample=0.8;, score=0.954 total time=   2.7s
[CV 2/3] END learning_rate=0.1, max_depth=3, n_estimators=200, subsample=0.8;, score=0.955 total time=   2.7s
[CV 3/3] END learning_rate=0.1, max_depth=3, n_estimators=200, subsample=0.8;, score=0.956 total time=   2.7s
[CV 1/3] END learning_rate=0.1, max_depth=3, n_estimators=200, subsample=1.0;, score=0.954 total time=   2.6s
[CV 2/3] END learning_rate=0.1, max_depth=3, n_estimators=200, subsample=1.0;, score=0.954 total time=   2.7s
[CV 3/3] END learning_rate=0.1, max_depth=3, n_estimators=200, subsample=1.0;, score=0.955 total time=   2.6s
[CV 1/3] END learning_rate=0.1, max_depth=3, n_estimators=300, subsample=0.6;, score=0.960 total time=   4.3s
[CV 2/3] END learning_rate=0.1, max_depth=3, n_estimators=300, subsample=0.6;, score=0.960 total time=   3.9s
[CV 3/3] END learning_rate=0.1, max_depth=3, n_estimators=300, subsample=0.6;, score=0.961 total time=   4.7s
[CV 1/3] END learning_rate=0.1, max_depth=3, n_estimators=300, subsample=0.8;, score=0.960 total time=   3.4s
[CV 2/3] END learning_rate=0.1, max_depth=3, n_estimators=300, subsample=0.8;, score=0.960 total time=   3.4s
[CV 3/3] END learning_rate=0.1, max_depth=3, n_estimators=300, subsample=0.8;, score=0.961 total time=   3.4s
[CV 1/3] END learning_rate=0.1, max_depth=3, n_estimators=300, subsample=1.0;, score=0.960 total time=   3.3s
[CV 2/3] END learning_rate=0.1, max_depth=3, n_estimators=300, subsample=1.0;, score=0.960 total time=   3.3s
[CV 3/3] END learning_rate=0.1, max_depth=3, n_estimators=300, subsample=1.0;, score=0.960 total time=   3.4s
[CV 1/3] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=0.6;, score=0.961 total time=   2.1s
[CV 2/3] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=0.6;, score=0.960 total time=   2.1s
[CV 3/3] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=0.6;, score=0.962 total time=   2.1s
[CV 1/3] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=0.8;, score=0.961 total time=   2.0s
[CV 2/3] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=0.8;, score=0.961 total time=   2.0s
[CV 3/3] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=0.8;, score=0.962 total time=   2.1s
[CV 1/3] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=1.0;, score=0.961 total time=   2.0s
[CV 2/3] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=1.0;, score=0.961 total time=   2.0s
[CV 3/3] END learning_rate=0.1, max_depth=5, n_estimators=100, subsample=1.0;, score=0.962 total time=   2.0s
[CV 1/3] END learning_rate=0.1, max_depth=5, n_estimators=200, subsample=0.6;, score=0.969 total time=   3.6s
[CV 2/3] END learning_rate=0.1, max_depth=5, n_estimators=200, subsample=0.6;, score=0.969 total time=   3.6s
[CV 3/3] END learning_rate=0.1, max_depth=5, n_estimators=200, subsample=0.6;, score=0.969 total time=   3.5s
[CV 1/3] END learning_rate=0.1, max_depth=5, n_estimators=200, subsample=0.8;, score=0.969 total time=   3.5s
[CV 2/3] END learning_rate=0.1, max_depth=5, n_estimators=200, subsample=0.8;, score=0.969 total time=   3.5s
[CV 3/3] END learning_rate=0.1, max_depth=5, n_estimators=200, subsample=0.8;, score=0.970 total time=   3.5s
[CV 1/3] END learning_rate=0.1, max_depth=5, n_estimators=200, subsample=1.0;, score=0.969 total time=   3.3s
[CV 2/3] END learning_rate=0.1, max_depth=5, n_estimators=200, subsample=1.0;, score=0.969 total time=   3.4s
[CV 3/3] END learning_rate=0.1, max_depth=5, n_estimators=200, subsample=1.0;, score=0.969 total time=   3.3s
[CV 1/3] END learning_rate=0.1, max_depth=5, n_estimators=300, subsample=0.6;, score=0.972 total time=   5.1s
[CV 2/3] END learning_rate=0.1, max_depth=5, n_estimators=300, subsample=0.6;, score=0.972 total time=   5.1s
[CV 3/3] END learning_rate=0.1, max_depth=5, n_estimators=300, subsample=0.6;, score=0.972 total time=   5.0s
[CV 1/3] END learning_rate=0.1, max_depth=5, n_estimators=300, subsample=0.8;, score=0.972 total time=   4.9s
[CV 2/3] END learning_rate=0.1, max_depth=5, n_estimators=300, subsample=0.8;, score=0.972 total time=   4.9s
[CV 3/3] END learning_rate=0.1, max_depth=5, n_estimators=300, subsample=0.8;, score=0.972 total time=   4.9s
[CV 1/3] END learning_rate=0.1, max_depth=5, n_estimators=300, subsample=1.0;, score=0.972 total time=   4.8s
[CV 2/3] END learning_rate=0.1, max_depth=5, n_estimators=300, subsample=1.0;, score=0.972 total time=   4.8s
[CV 3/3] END learning_rate=0.1, max_depth=5, n_estimators=300, subsample=1.0;, score=0.972 total time=   4.8s
[CV 1/3] END learning_rate=0.1, max_depth=7, n_estimators=100, subsample=0.6;, score=0.971 total time=   2.7s
[CV 2/3] END learning_rate=0.1, max_depth=7, n_estimators=100, subsample=0.6;, score=0.970 total time=   2.6s
[CV 3/3] END learning_rate=0.1, max_depth=7, n_estimators=100, subsample=0.6;, score=0.971 total time=   2.7s
[CV 1/3] END learning_rate=0.1, max_depth=7, n_estimators=100, subsample=0.8;, score=0.971 total time=   2.6s
[CV 2/3] END learning_rate=0.1, max_depth=7, n_estimators=100, subsample=0.8;, score=0.971 total time=   2.6s
[CV 3/3] END learning_rate=0.1, max_depth=7, n_estimators=100, subsample=0.8;, score=0.971 total time=   2.6s
[CV 1/3] END learning_rate=0.1, max_depth=7, n_estimators=100, subsample=1.0;, score=0.970 total time=   2.5s
[CV 2/3] END learning_rate=0.1, max_depth=7, n_estimators=100, subsample=1.0;, score=0.971 total time=   2.6s
[CV 3/3] END learning_rate=0.1, max_depth=7, n_estimators=100, subsample=1.0;, score=0.971 total time=   2.6s
[CV 1/3] END learning_rate=0.1, max_depth=7, n_estimators=200, subsample=0.6;, score=0.975 total time=   4.9s
[CV 2/3] END learning_rate=0.1, max_depth=7, n_estimators=200, subsample=0.6;, score=0.975 total time=   4.7s
[CV 3/3] END learning_rate=0.1, max_depth=7, n_estimators=200, subsample=0.6;, score=0.975 total time=   4.7s
[CV 1/3] END learning_rate=0.1, max_depth=7, n_estimators=200, subsample=0.8;, score=0.975 total time=   4.6s
[CV 2/3] END learning_rate=0.1, max_depth=7, n_estimators=200, subsample=0.8;, score=0.975 total time=   4.6s
[CV 3/3] END learning_rate=0.1, max_depth=7, n_estimators=200, subsample=0.8;, score=0.975 total time=   4.7s
[CV 1/3] END learning_rate=0.1, max_depth=7, n_estimators=200, subsample=1.0;, score=0.975 total time=   4.5s
[CV 2/3] END learning_rate=0.1, max_depth=7, n_estimators=200, subsample=1.0;, score=0.975 total time=   4.5s
[CV 3/3] END learning_rate=0.1, max_depth=7, n_estimators=200, subsample=1.0;, score=0.975 total time=   4.6s
[CV 1/3] END learning_rate=0.1, max_depth=7, n_estimators=300, subsample=0.6;, score=0.977 total time=   6.7s
[CV 2/3] END learning_rate=0.1, max_depth=7, n_estimators=300, subsample=0.6;, score=0.977 total time=   6.7s
[CV 3/3] END learning_rate=0.1, max_depth=7, n_estimators=300, subsample=0.6;, score=0.977 total time=   6.9s
[CV 1/3] END learning_rate=0.1, max_depth=7, n_estimators=300, subsample=0.8;, score=0.977 total time=   6.8s
[CV 2/3] END learning_rate=0.1, max_depth=7, n_estimators=300, subsample=0.8;, score=0.977 total time=   6.6s
[CV 3/3] END learning_rate=0.1, max_depth=7, n_estimators=300, subsample=0.8;, score=0.977 total time=   6.6s
[CV 1/3] END learning_rate=0.1, max_depth=7, n_estimators=300, subsample=1.0;, score=0.977 total time=   6.5s
[CV 2/3] END learning_rate=0.1, max_depth=7, n_estimators=300, subsample=1.0;, score=0.976 total time=   6.5s
[CV 3/3] END learning_rate=0.1, max_depth=7, n_estimators=300, subsample=1.0;, score=0.977 total time=   6.4s
[CV 1/3] END learning_rate=0.2, max_depth=3, n_estimators=100, subsample=0.6;, score=0.954 total time=   1.3s
[CV 2/3] END learning_rate=0.2, max_depth=3, n_estimators=100, subsample=0.6;, score=0.954 total time=   1.4s
[CV 3/3] END learning_rate=0.2, max_depth=3, n_estimators=100, subsample=0.6;, score=0.954 total time=   1.4s
[CV 1/3] END learning_rate=0.2, max_depth=3, n_estimators=100, subsample=0.8;, score=0.954 total time=   1.3s
[CV 2/3] END learning_rate=0.2, max_depth=3, n_estimators=100, subsample=0.8;, score=0.954 total time=   1.4s
[CV 3/3] END learning_rate=0.2, max_depth=3, n_estimators=100, subsample=0.8;, score=0.955 total time=   1.3s
[CV 1/3] END learning_rate=0.2, max_depth=3, n_estimators=100, subsample=1.0;, score=0.955 total time=   1.3s
[CV 2/3] END learning_rate=0.2, max_depth=3, n_estimators=100, subsample=1.0;, score=0.954 total time=   1.3s
[CV 3/3] END learning_rate=0.2, max_depth=3, n_estimators=100, subsample=1.0;, score=0.955 total time=   1.2s
[CV 1/3] END learning_rate=0.2, max_depth=3, n_estimators=200, subsample=0.6;, score=0.962 total time=   2.5s
[CV 2/3] END learning_rate=0.2, max_depth=3, n_estimators=200, subsample=0.6;, score=0.962 total time=   2.5s
[CV 3/3] END learning_rate=0.2, max_depth=3, n_estimators=200, subsample=0.6;, score=0.962 total time=   2.5s
[CV 1/3] END learning_rate=0.2, max_depth=3, n_estimators=200, subsample=0.8;, score=0.962 total time=   2.4s
[CV 2/3] END learning_rate=0.2, max_depth=3, n_estimators=200, subsample=0.8;, score=0.963 total time=   2.6s
[CV 3/3] END learning_rate=0.2, max_depth=3, n_estimators=200, subsample=0.8;, score=0.963 total time=   2.5s
[CV 1/3] END learning_rate=0.2, max_depth=3, n_estimators=200, subsample=1.0;, score=0.963 total time=   2.3s
[CV 2/3] END learning_rate=0.2, max_depth=3, n_estimators=200, subsample=1.0;, score=0.963 total time=   2.3s
[CV 3/3] END learning_rate=0.2, max_depth=3, n_estimators=200, subsample=1.0;, score=0.963 total time=   2.3s
[CV 1/3] END learning_rate=0.2, max_depth=3, n_estimators=300, subsample=0.6;, score=0.966 total time=   3.4s
[CV 2/3] END learning_rate=0.2, max_depth=3, n_estimators=300, subsample=0.6;, score=0.966 total time=   3.4s
[CV 3/3] END learning_rate=0.2, max_depth=3, n_estimators=300, subsample=0.6;, score=0.966 total time=   3.5s
[CV 1/3] END learning_rate=0.2, max_depth=3, n_estimators=300, subsample=0.8;, score=0.966 total time=   3.3s
[CV 2/3] END learning_rate=0.2, max_depth=3, n_estimators=300, subsample=0.8;, score=0.966 total time=   3.4s
[CV 3/3] END learning_rate=0.2, max_depth=3, n_estimators=300, subsample=0.8;, score=0.967 total time=   3.4s
[CV 1/3] END learning_rate=0.2, max_depth=3, n_estimators=300, subsample=1.0;, score=0.966 total time=   3.2s
[CV 2/3] END learning_rate=0.2, max_depth=3, n_estimators=300, subsample=1.0;, score=0.966 total time=   3.2s
[CV 3/3] END learning_rate=0.2, max_depth=3, n_estimators=300, subsample=1.0;, score=0.967 total time=   3.2s
[CV 1/3] END learning_rate=0.2, max_depth=5, n_estimators=100, subsample=0.6;, score=0.969 total time=   2.0s
[CV 2/3] END learning_rate=0.2, max_depth=5, n_estimators=100, subsample=0.6;, score=0.969 total time=   2.0s
[CV 3/3] END learning_rate=0.2, max_depth=5, n_estimators=100, subsample=0.6;, score=0.968 total time=   2.0s
[CV 1/3] END learning_rate=0.2, max_depth=5, n_estimators=100, subsample=0.8;, score=0.968 total time=   1.9s
[CV 2/3] END learning_rate=0.2, max_depth=5, n_estimators=100, subsample=0.8;, score=0.968 total time=   2.0s
[CV 3/3] END learning_rate=0.2, max_depth=5, n_estimators=100, subsample=0.8;, score=0.969 total time=   2.0s
[CV 1/3] END learning_rate=0.2, max_depth=5, n_estimators=100, subsample=1.0;, score=0.969 total time=   1.9s
[CV 2/3] END learning_rate=0.2, max_depth=5, n_estimators=100, subsample=1.0;, score=0.969 total time=   1.9s
[CV 3/3] END learning_rate=0.2, max_depth=5, n_estimators=100, subsample=1.0;, score=0.969 total time=   1.9s
[CV 1/3] END learning_rate=0.2, max_depth=5, n_estimators=200, subsample=0.6;, score=0.973 total time=   3.6s
[CV 2/3] END learning_rate=0.2, max_depth=5, n_estimators=200, subsample=0.6;, score=0.973 total time=   3.4s
[CV 3/3] END learning_rate=0.2, max_depth=5, n_estimators=200, subsample=0.6;, score=0.973 total time=   3.5s
[CV 1/3] END learning_rate=0.2, max_depth=5, n_estimators=200, subsample=0.8;, score=0.973 total time=   3.4s
[CV 2/3] END learning_rate=0.2, max_depth=5, n_estimators=200, subsample=0.8;, score=0.973 total time=   3.4s
[CV 3/3] END learning_rate=0.2, max_depth=5, n_estimators=200, subsample=0.8;, score=0.973 total time=   3.4s
[CV 1/3] END learning_rate=0.2, max_depth=5, n_estimators=200, subsample=1.0;, score=0.973 total time=   3.3s
[CV 2/3] END learning_rate=0.2, max_depth=5, n_estimators=200, subsample=1.0;, score=0.973 total time=   3.3s
[CV 3/3] END learning_rate=0.2, max_depth=5, n_estimators=200, subsample=1.0;, score=0.973 total time=   3.3s
[CV 1/3] END learning_rate=0.2, max_depth=5, n_estimators=300, subsample=0.6;, score=0.975 total time=   5.0s
[CV 2/3] END learning_rate=0.2, max_depth=5, n_estimators=300, subsample=0.6;, score=0.975 total time=   5.0s
[CV 3/3] END learning_rate=0.2, max_depth=5, n_estimators=300, subsample=0.6;, score=0.975 total time=   4.9s
[CV 1/3] END learning_rate=0.2, max_depth=5, n_estimators=300, subsample=0.8;, score=0.975 total time=   4.8s
[CV 2/3] END learning_rate=0.2, max_depth=5, n_estimators=300, subsample=0.8;, score=0.975 total time=   4.8s
[CV 3/3] END learning_rate=0.2, max_depth=5, n_estimators=300, subsample=0.8;, score=0.975 total time=   4.9s
[CV 1/3] END learning_rate=0.2, max_depth=5, n_estimators=300, subsample=1.0;, score=0.975 total time=   4.8s
[CV 2/3] END learning_rate=0.2, max_depth=5, n_estimators=300, subsample=1.0;, score=0.975 total time=   4.6s
[CV 3/3] END learning_rate=0.2, max_depth=5, n_estimators=300, subsample=1.0;, score=0.975 total time=   4.7s
[CV 1/3] END learning_rate=0.2, max_depth=7, n_estimators=100, subsample=0.6;, score=0.974 total time=   2.6s
[CV 2/3] END learning_rate=0.2, max_depth=7, n_estimators=100, subsample=0.6;, score=0.975 total time=   2.5s
[CV 3/3] END learning_rate=0.2, max_depth=7, n_estimators=100, subsample=0.6;, score=0.975 total time=   2.6s
[CV 1/3] END learning_rate=0.2, max_depth=7, n_estimators=100, subsample=0.8;, score=0.975 total time=   2.5s
[CV 2/3] END learning_rate=0.2, max_depth=7, n_estimators=100, subsample=0.8;, score=0.974 total time=   2.5s
[CV 3/3] END learning_rate=0.2, max_depth=7, n_estimators=100, subsample=0.8;, score=0.975 total time=   2.6s
[CV 1/3] END learning_rate=0.2, max_depth=7, n_estimators=100, subsample=1.0;, score=0.975 total time=   2.7s
[CV 2/3] END learning_rate=0.2, max_depth=7, n_estimators=100, subsample=1.0;, score=0.974 total time=   2.5s
[CV 3/3] END learning_rate=0.2, max_depth=7, n_estimators=100, subsample=1.0;, score=0.975 total time=   2.5s
[CV 1/3] END learning_rate=0.2, max_depth=7, n_estimators=200, subsample=0.6;, score=0.977 total time=   4.7s
[CV 2/3] END learning_rate=0.2, max_depth=7, n_estimators=200, subsample=0.6;, score=0.977 total time=   4.6s
[CV 3/3] END learning_rate=0.2, max_depth=7, n_estimators=200, subsample=0.6;, score=0.977 total time=   4.5s
[CV 1/3] END learning_rate=0.2, max_depth=7, n_estimators=200, subsample=0.8;, score=0.977 total time=   4.5s
[CV 2/3] END learning_rate=0.2, max_depth=7, n_estimators=200, subsample=0.8;, score=0.977 total time=   4.6s
[CV 3/3] END learning_rate=0.2, max_depth=7, n_estimators=200, subsample=0.8;, score=0.978 total time=   4.7s
[CV 1/3] END learning_rate=0.2, max_depth=7, n_estimators=200, subsample=1.0;, score=0.977 total time=   4.4s
[CV 2/3] END learning_rate=0.2, max_depth=7, n_estimators=200, subsample=1.0;, score=0.977 total time=   4.4s
[CV 3/3] END learning_rate=0.2, max_depth=7, n_estimators=200, subsample=1.0;, score=0.977 total time=   4.4s
[CV 1/3] END learning_rate=0.2, max_depth=7, n_estimators=300, subsample=0.6;, score=0.978 total time=   6.6s
[CV 2/3] END learning_rate=0.2, max_depth=7, n_estimators=300, subsample=0.6;, score=0.978 total time=   6.6s
[CV 3/3] END learning_rate=0.2, max_depth=7, n_estimators=300, subsample=0.6;, score=0.978 total time=   7.2s
[CV 1/3] END learning_rate=0.2, max_depth=7, n_estimators=300, subsample=0.8;, score=0.978 total time=   6.9s
[CV 2/3] END learning_rate=0.2, max_depth=7, n_estimators=300, subsample=0.8;, score=0.978 total time=   6.6s
[CV 3/3] END learning_rate=0.2, max_depth=7, n_estimators=300, subsample=0.8;, score=0.979 total time=   6.6s
[CV 1/3] END learning_rate=0.2, max_depth=7, n_estimators=300, subsample=1.0;, score=0.978 total time=   6.6s
[CV 2/3] END learning_rate=0.2, max_depth=7, n_estimators=300, subsample=1.0;, score=0.978 total time=   6.4s
[CV 3/3] END learning_rate=0.2, max_depth=7, n_estimators=300, subsample=1.0;, score=0.978 total time=   6.3s</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="45">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=3, error_score='raise',
             estimator=XGBRegressor(base_score=None, booster=None,
                                    callbacks=None, colsample_bylevel=None,
                                    colsample_bynode=None,
                                    colsample_bytree=None, device=None,
                                    early_stopping_rounds=None,
                                    enable_categorical=False, eval_metric=None,
                                    feature_types=None, gamma=None,
                                    grow_policy=None, importance_type=None,
                                    interaction_constraints=None,...
                                    max_cat_to_onehot=None, max_delta_step=None,
                                    max_depth=None, max_leaves=None,
                                    min_child_weight=None, missing=nan,
                                    monotone_constraints=None,
                                    multi_strategy=None, n_estimators=None,
                                    n_jobs=None, num_parallel_tree=None,
                                    random_state=42, ...),
             n_jobs=1,
             param_grid={'learning_rate': [0.01, 0.1, 0.2],
                         'max_depth': [3, 5, 7],
                         'n_estimators': [100, 200, 300],
                         'subsample': [0.6, 0.8, 1.0]},
             scoring='r2', verbose=3)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GridSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.GridSearchCV.html">?<span>Documentation for GridSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GridSearchCV(cv=3, error_score='raise',
             estimator=XGBRegressor(base_score=None, booster=None,
                                    callbacks=None, colsample_bylevel=None,
                                    colsample_bynode=None,
                                    colsample_bytree=None, device=None,
                                    early_stopping_rounds=None,
                                    enable_categorical=False, eval_metric=None,
                                    feature_types=None, gamma=None,
                                    grow_policy=None, importance_type=None,
                                    interaction_constraints=None,...
                                    max_cat_to_onehot=None, max_delta_step=None,
                                    max_depth=None, max_leaves=None,
                                    min_child_weight=None, missing=nan,
                                    monotone_constraints=None,
                                    multi_strategy=None, n_estimators=None,
                                    n_jobs=None, num_parallel_tree=None,
                                    random_state=42, ...),
             n_jobs=1,
             param_grid={'learning_rate': [0.01, 0.1, 0.2],
                         'max_depth': [3, 5, 7],
                         'n_estimators': [100, 200, 300],
                         'subsample': [0.6, 0.8, 1.0]},
             scoring='r2', verbose=3)</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: XGBRegressor</label><div class="sk-toggleable__content fitted"><pre>XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=None,
             enable_categorical=False, eval_metric=None, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=0.2, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=7, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=300, n_jobs=None,
             num_parallel_tree=None, random_state=42, ...)</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">XGBRegressor</label><div class="sk-toggleable__content fitted"><pre>XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=None,
             enable_categorical=False, eval_metric=None, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=0.2, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=7, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=300, n_jobs=None,
             num_parallel_tree=None, random_state=42, ...)</pre></div> </div></div></div></div></div></div></div></div></div>
</div>
</div>
<div id="cell-70" class="cell" data-execution_count="46">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"XGB Best Score - </span><span class="sc">{</span>xgb_grid<span class="sc">.</span>best_score_<span class="sc">}</span><span class="ch">\n\n</span><span class="ss">XGB Best Params - </span><span class="sc">{</span>xgb_grid<span class="sc">.</span>best_params_<span class="sc">}</span><span class="ch">\n\n</span><span class="ss">XGB Best Estimater - </span><span class="sc">{</span>xgb_grid<span class="sc">.</span>best_estimator_<span class="sc">}</span><span class="ss"> </span><span class="ch">\n\n</span><span class="ss">XGB Best Index - </span><span class="sc">{</span>xgb_grid<span class="sc">.</span>best_index_<span class="sc">}</span><span class="ss"> "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>XGB Best Score - 0.9783696742886985

XGB Best Params - {'learning_rate': 0.2, 'max_depth': 7, 'n_estimators': 300, 'subsample': 0.8}

XGB Best Estimater - XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=None,
             enable_categorical=False, eval_metric=None, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=0.2, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=7, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=300, n_jobs=None,
             num_parallel_tree=None, random_state=42, ...) 

XGB Best Index - 79 </code></pre>
</div>
</div>
<div id="cell-71" class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>XGB_model <span class="op">=</span> XGBRegressor(learning_rate<span class="op">=</span><span class="fl">0.2</span>, max_depth<span class="op">=</span><span class="dv">7</span>, n_estimators<span class="op">=</span><span class="dv">300</span>, n_jobs<span class="op">=</span><span class="va">None</span>, random_state<span class="op">=</span><span class="dv">42</span>,) </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>XGB_model.fit(x_train,y_train)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>y_preds<span class="op">=</span>XGB_model.predict(x_test)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>y_preds_train <span class="op">=</span> XGB_model.predict(x_train)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>training_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Training Time: </span><span class="sc">{</span>training_time<span class="sc">:.2f}</span><span class="ss"> seconds</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Root Mean Squared Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>root_mean_squared_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train R2 Score </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>r2_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Mean Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>mean_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Median Absolute Error </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>median_absolute_error(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Test Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_test,y_preds)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>color_positive<span class="sc">}</span><span class="ss">Train Explained Var </span><span class="sc">{</span>reset_color<span class="sc">}</span><span class="ss"> -- </span><span class="sc">{</span>explained_variance_score(y_train,y_preds_train)<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)    </span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Training Time: 11.48 seconds

Test Mean Squared Error  -- 1787.01
Train Mean Squared Error  -- 1700.37

Test Root Mean Squared Error  -- 42.27
Train Root Mean Squared Error  -- 41.24

Test R2 Score  -- 0.98
Train R2 Score  -- 0.98

Test Mean Absolute Error  -- 31.69
Train Mean Absolute Error  -- 30.99

Test Median Absolute Error  -- 24.39
Train Median Absolute Error  -- 23.97

Test Explained Var  -- 0.98
Train Explained Var  -- 0.98

--------------------------------------------------</code></pre>
</div>
</div>
<div id="cell-72" class="cell" data-execution_count="44">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>os.makedirs(<span class="st">'pkls'</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="vs">r'pkls/XGB_model.pkl'</span>, <span class="st">'wb'</span>) <span class="im">as</span> f:</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    pickle.dump(XGB_model,f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-73" class="cell" data-execution_count="64">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df1.lease_commence_date.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_13541/1588792640.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>df1<span class="ansi-blue-fg">.</span>lease_commence_date<span class="ansi-blue-fg">.</span>value_counts<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/f_drive/Technology/Python Project/Capstone/Singapore-Resale-Flat-Prices-Predicting/singapore/lib/python3.10/site-packages/pandas/core/generic.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-fg ansi-bold">   6295</span>             <span class="ansi-green-fg">and</span> name <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>_accessors
<span class="ansi-green-fg ansi-bold">   6296</span>             <span class="ansi-green-fg">and</span> self<span class="ansi-blue-fg">.</span>_info_axis<span class="ansi-blue-fg">.</span>_can_hold_identifiers_and_holds_name<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg ansi-bold">   6297</span>         ):
<span class="ansi-green-fg ansi-bold">   6298</span>             <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">[</span>name<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">-&gt; 6299</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> object<span class="ansi-blue-fg">.</span>__getattribute__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">AttributeError</span>: 'DataFrame' object has no attribute 'lease_commence_date'</pre>
</div>
</div>
</div>
<div id="cell-74" class="cell" data-execution_count="62">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>df1.sample(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">resale_price_boxcox</th>
<th data-quarto-table-cell-role="th">floor_area_boxcox</th>
<th data-quarto-table-cell-role="th">town_en</th>
<th data-quarto-table-cell-role="th">year_en</th>
<th data-quarto-table-cell-role="th">flat_type_en</th>
<th data-quarto-table-cell-role="th">flat_model_en</th>
<th data-quarto-table-cell-role="th">lease_commence_en</th>
<th data-quarto-table-cell-role="th">floors_en</th>
<th data-quarto-table-cell-role="th">floor_no_en</th>
<th data-quarto-table-cell-role="th">remaining_lease_year_en</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">185313</td>
<td>685.2071</td>
<td>12.5358</td>
<td>24</td>
<td>15</td>
<td>5</td>
<td>7</td>
<td>35</td>
<td>1</td>
<td>2</td>
<td>33</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">60326</td>
<td>382.7690</td>
<td>9.1977</td>
<td>7</td>
<td>10</td>
<td>3</td>
<td>3</td>
<td>21</td>
<td>1</td>
<td>3</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1020</td>
<td>311.0465</td>
<td>10.7165</td>
<td>13</td>
<td>1</td>
<td>4</td>
<td>7</td>
<td>8</td>
<td>1</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">89934</td>
<td>628.2771</td>
<td>12.0472</td>
<td>15</td>
<td>7</td>
<td>5</td>
<td>7</td>
<td>28</td>
<td>1</td>
<td>4</td>
<td>45</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>

</b></main><b>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</b></div><b> <!-- /content -->




</b></body></html>